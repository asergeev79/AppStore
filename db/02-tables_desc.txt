use appstore;

DESC accounts ;
# Таблица учётных записей, характеризующаяся электронной почтой
SELECT * FROM accounts a LIMIT 10;

DESC app_account ;
# Таблица, в которой указывается связь приложения и аккаунта с учётом статуса (загружено, установлено и т.п.)
# Приложение может быть установлено у многих аккаунтов, как и аккаунт иметь множество установленных приложений
# Связь устанавливается без учёта архитектуры, версионности: лицензия распространяется на всю линейку
SELECT * FROM app_account aa ; 

DESC app_arch ;
# Таблица соответствия приложения к какой-то архитектуре
# Релиз может иметь название, а может и нет: name
SELECT * FROM app_arch aa ;

DESC app_device ;
# Таблица связи приложения и устройства. 
# Здесь описывается статус именно версии приложения для конкретного устройства, чтобы можно было уведомлять
# об обновлениях.
SELECT * FROM app_device ad ;

DESC app_os;
# Таблица привязки приложения под определённую архитектуру к ОС.
# Здесь необходимо контролировать, чтобы приложение с id, равным os_id, было в категории "Операционные системы"
SELECT * FROM app_os ao ;

SELECT DISTINCT ao.os_id, ca.category_id FROM 
	app_os ao 
	JOIN
	categories_apps ca 
ON 
	ao.os_id = ca.app_id ;
	
DESC app_statuses ;
# Словарь статусов приложений
SELECT * FROM app_statuses as2 ;

DESC app_versions ;
# Таблица версий приложений. Ссылается на приложение для определённой ОС и под определённую архитектуру.
# Здесь необходимо отслеживать версии по дате релиза: чем выше версия, тем дата позднее.
# При начальном заполнении использовалась одна версия под приложение
SELECT * FROM app_versions av ;

DESC applications ;
# Список приложений с указанием вендора.
# Идентификатор вендора должен соответствовать аккаунту с меткой is_dev = 1;
SELECT is_dev, COUNT(is_dev) FROM 
	applications a 
	JOIN
	profiles p 
ON 
	a.vendor_id = p.account_id 
GROUP BY p.is_dev ;

DESC architectures ;
# Словарь архитектур: x86-64, arm и т.д
SELECT * FROM architectures a ;

DESC categories ;
# Словарь категорий ПО
SELECT * FROM categories c ;

DESC categories_apps ;
# Таблица принадлежности ПО к определённой категории
# ПО может относиться к нескольким категориям
SELECT * FROM categories_apps ca ;

DESC certificate_types ;
# Словарь требований, по которым выпускаются сертификаты
SELECT * FROM certificate_types ct ;

DESC certificates ;
# Таблица сертификатов соответствия определённым требованиям определённых регуляторов
# Сертификат выпускается под конкретную версию ПО
# Дата выпуска должна быть больше даты окончания
SELECT * FROM certificates c ;

DESC `data` ;
# Таблица физических данных: картинки - логотипы, скриншоты, дистрибутивы, файлы описаний версий ПО и т.п.
# Размещение по URL
SELECT * FROM `data` d ;

DESC data_types ;
# Словарь типов данных: дистрибутивов, картинок и т.п.
SELECT * FROM data_types dt ;

DESC devices ;
# Список устройств, привязанных к аккаунту.
# Однозначно определяется профилем: uuid, json и т.д.
SELECT * FROM devices d ;

DESC profiles ;
# Таблица профилей аккаунтов. Определяет, является ли аккаунт организацией, разработчиком.
# Также возможна привязка личного аккаунта к корпоративному.
# Здесь надо проверять, что org_id должен соответствовать аккаунту организации
SELECT p2.is_org FROM 
	profiles p
	JOIN
	profiles p2 
ON 
	p.org_id = p2.account_id
GROUP BY p2.is_org ;

DESC regulators ;
# Словарь регуляторов: ФСБ, ФСТЭК, МинОбороны
SELECT * FROM regulators r ;
